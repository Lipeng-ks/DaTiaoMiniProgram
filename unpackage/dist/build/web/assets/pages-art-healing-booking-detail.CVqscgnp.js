import{s as a,z as t,c as e,w as s,i as l,o,a as n,e as i,t as c,j as d,q as f,h as u,u as r}from"./index-CUhQkSZ9.js";import{A as g}from"./art-booking.service.IIZGVjuH.js";import{_}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./storage.service.Bt6PQ2bo.js";const k=_({data:()=>({bookingId:"",booking:null,loading:!0,canCancelBooking:!1}),onLoad(a){this.bookingId=a.id,this.loadBookingDetail()},methods:{async loadBookingDetail(){this.loading=!0;try{this.booking=await g.getArtBookingDetail(this.bookingId),this.checkCanCancel()}catch(t){console.error("Failed to load booking detail:",t),a({title:"加载失败",icon:"none"})}finally{this.loading=!1}},checkCanCancel(){this.booking?this.canCancelBooking=g.canCancelArtBooking(this.booking):this.canCancelBooking=!1},async handleCancel(){t({title:"确认取消",content:"确定要取消此预约吗？",success:async a=>{a.confirm&&await this.cancelBooking()}})},async cancelBooking(){try{const t=await g.cancelArtBooking(this.bookingId);t.success?(a({title:"取消成功",icon:"success"}),await this.loadBookingDetail()):a({title:t.message,icon:"none"})}catch(t){console.error("Failed to cancel booking:",t),a({title:"取消失败",icon:"none"})}},getStatusClass:a=>({pending:"status-pending",confirmed:"status-confirmed",cancelled:"status-cancelled",completed:"status-completed"}[a]||""),getStatusIcon:a=>({pending:"⏳",confirmed:"✓",cancelled:"✕",completed:"★"}[a]||"?"),getStatusText:a=>({pending:"待确认",confirmed:"已确认",cancelled:"已取消",completed:"已完成"}[a]||a),formatDate(a){if(!a)return"";const t=new Date(a);return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")} ${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}`}}},[["render",function(a,t,g,_,k,b){const m=u,p=l,h=r;return o(),e(p,{class:"booking-detail-container"},{default:s((()=>[n(p,{class:"header"},{default:s((()=>[n(m,{class:"title"},{default:s((()=>[i("预约详情")])),_:1})])),_:1}),k.loading?(o(),e(p,{key:0,class:"loading"},{default:s((()=>[n(m,null,{default:s((()=>[i("加载中...")])),_:1})])),_:1})):k.booking?(o(),e(p,{key:1,class:"detail-content"},{default:s((()=>[n(p,{class:d(["status-card",b.getStatusClass(k.booking.status)])},{default:s((()=>[n(m,{class:"status-icon"},{default:s((()=>[i(c(b.getStatusIcon(k.booking.status)),1)])),_:1}),n(m,{class:"status-text"},{default:s((()=>[i(c(b.getStatusText(k.booking.status)),1)])),_:1})])),_:1},8,["class"]),n(p,{class:"info-section"},{default:s((()=>[n(m,{class:"section-title"},{default:s((()=>[i("活动信息")])),_:1}),n(p,{class:"info-card"},{default:s((()=>[n(p,{class:"info-row"},{default:s((()=>[n(m,{class:"info-label"},{default:s((()=>[i("活动名称")])),_:1}),n(m,{class:"info-value"},{default:s((()=>[i(c(k.booking.festivalTitle),1)])),_:1})])),_:1}),n(p,{class:"info-row"},{default:s((()=>[n(m,{class:"info-label"},{default:s((()=>[i("活动日期")])),_:1}),n(m,{class:"info-value"},{default:s((()=>[i(c(k.booking.festivalDate),1)])),_:1})])),_:1}),n(p,{class:"info-row"},{default:s((()=>[n(m,{class:"info-label"},{default:s((()=>[i("活动时间")])),_:1}),n(m,{class:"info-value"},{default:s((()=>[i(c(k.booking.festivalTime),1)])),_:1})])),_:1}),n(p,{class:"info-row"},{default:s((()=>[n(m,{class:"info-label"},{default:s((()=>[i("活动地点")])),_:1}),n(m,{class:"info-value"},{default:s((()=>[i(c(k.booking.festivalLocation),1)])),_:1})])),_:1})])),_:1})])),_:1}),n(p,{class:"info-section"},{default:s((()=>[n(m,{class:"section-title"},{default:s((()=>[i("预约人信息")])),_:1}),n(p,{class:"info-card"},{default:s((()=>[n(p,{class:"info-row"},{default:s((()=>[n(m,{class:"info-label"},{default:s((()=>[i("姓名")])),_:1}),n(m,{class:"info-value"},{default:s((()=>[i(c(k.booking.formData.name),1)])),_:1})])),_:1}),n(p,{class:"info-row"},{default:s((()=>[n(m,{class:"info-label"},{default:s((()=>[i("手机号")])),_:1}),n(m,{class:"info-value"},{default:s((()=>[i(c(k.booking.formData.phone),1)])),_:1})])),_:1}),n(p,{class:"info-row"},{default:s((()=>[n(m,{class:"info-label"},{default:s((()=>[i("参与人数")])),_:1}),n(m,{class:"info-value"},{default:s((()=>[i(c(k.booking.formData.participants)+"人",1)])),_:1})])),_:1}),k.booking.formData.remark?(o(),e(p,{key:0,class:"info-row"},{default:s((()=>[n(m,{class:"info-label"},{default:s((()=>[i("备注")])),_:1}),n(m,{class:"info-value"},{default:s((()=>[i(c(k.booking.formData.remark),1)])),_:1})])),_:1})):f("",!0)])),_:1})])),_:1}),n(p,{class:"info-section"},{default:s((()=>[n(m,{class:"section-title"},{default:s((()=>[i("预约时间")])),_:1}),n(p,{class:"info-card"},{default:s((()=>[n(p,{class:"info-row"},{default:s((()=>[n(m,{class:"info-label"},{default:s((()=>[i("创建时间")])),_:1}),n(m,{class:"info-value"},{default:s((()=>[i(c(b.formatDate(k.booking.createdAt)),1)])),_:1})])),_:1}),k.booking.updatedAt!==k.booking.createdAt?(o(),e(p,{key:0,class:"info-row"},{default:s((()=>[n(m,{class:"info-label"},{default:s((()=>[i("更新时间")])),_:1}),n(m,{class:"info-value"},{default:s((()=>[i(c(b.formatDate(k.booking.updatedAt)),1)])),_:1})])),_:1})):f("",!0)])),_:1})])),_:1}),k.canCancelBooking?(o(),e(p,{key:0,class:"action-section"},{default:s((()=>[n(h,{class:"cancel-btn",onClick:b.handleCancel},{default:s((()=>[i("取消预约")])),_:1},8,["onClick"]),n(m,{class:"cancel-tip"},{default:s((()=>[i("距离活动开始超过24小时可取消")])),_:1})])),_:1})):"confirmed"===k.booking.status||"pending"===k.booking.status?(o(),e(p,{key:1,class:"action-section"},{default:s((()=>[n(m,{class:"cannot-cancel-tip"},{default:s((()=>[i("距离活动开始不足24小时，无法取消")])),_:1})])),_:1})):f("",!0)])),_:1})):(o(),e(p,{key:2,class:"empty-state"},{default:s((()=>[n(m,{class:"empty-text"},{default:s((()=>[i("未找到预约信息")])),_:1})])),_:1}))])),_:1})}],["__scopeId","data-v-e3f09cd0"]]);export{k as default};
