import{S as e}from"./storage.service.D1zc2f4B.js";function t(e){if(!e)return!1;if("pending"!==e.status&&"confirmed"!==e.status)return!1;return(new Date(`${e.eventDate}T${e.eventTime}`)-new Date)/36e5>=24}const n={createBooking:async function(t,n,a){try{const s=(new Date).toISOString(),o={id:Date.now().toString(36)+Math.random().toString(36).substr(2,9),eventId:t,eventTitle:n.title,eventDate:n.date,eventTime:n.time,eventLocation:n.location,formData:{name:a.name,phone:a.phone,participants:a.participants||1,remark:a.remark||""},status:"pending",createdAt:s,updatedAt:s};return await e.saveBooking(o),{success:!0,bookingId:o.id,message:"预约成功"}}catch(s){return console.error("Failed to create booking:",s),{success:!1,message:"预约失败，请重试"}}},cancelBooking:async function(n){try{const a=await e.getBookingById(n);return a?t(a)?(await e.updateBooking(n,{status:"cancelled"}),{success:!0,message:"取消成功"}):{success:!1,message:"距离活动开始不足24小时，无法取消"}:{success:!1,message:"预约记录不存在"}}catch(a){return console.error("Failed to cancel booking:",a),{success:!1,message:"取消失败，请重试"}}},canCancel:t,getUserBookings:async function(){try{return(await e.getBookings()).sort(((e,t)=>new Date(`${e.eventDate}T${e.eventTime}`)-new Date(`${t.eventDate}T${t.eventTime}`)))}catch(t){return console.error("Failed to get user bookings:",t),[]}},getBookingDetail:async function(t){return e.getBookingById(t)},validateForm:function(e){const t=[];return e.name&&e.name.trim()||t.push({field:"name",message:"请输入姓名"}),e.phone&&e.phone.trim()?/^1[3-9]\d{9}$/.test(e.phone)||t.push({field:"phone",message:"请输入正确的手机号码"}):t.push({field:"phone",message:"请输入手机号"}),{valid:0===t.length,errors:t}}};export{n as B};
