import{g as a,s as l,n as e,m as s,c as o,w as t,d as i,i as n,o as r,a as c,b as d,e as m,r as f,F as u,v as h,t as _,p,h as g,f as k,q as b,I as v,x as D,u as C}from"./index-BDtgVNeI.js";import{C as S}from"./CustomNavBar.DdiFadKl.js";import{A as F}from"./aroma-booking.service.BANsHl7w.js";import{_ as y}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./storage.service.D1zc2f4B.js";const B=y({components:{CustomNavBar:S},data:()=>({navPaddingTop:100,salons:[],selectedSalon:null,showBookingForm:!1,showConfirmation:!1,loading:!0,confirmationData:{salonTitle:"",salonDate:"",salonTime:"",salonLocation:"",name:"",phone:"",participants:1},formData:{name:"",phone:"",participants:1,remark:""},formErrors:{}}),onLoad(){const l=a();this.navPaddingTop=(l.statusBarHeight||20)+75,this.loadSalons()},methods:{async loadSalons(){this.loading=!0;try{this.salons=await F.getSalons()}catch(a){console.error("Failed to load salons:",a),l({title:"åŠ è½½å¤±è´¥ï¼Œè¯·é‡è¯•",icon:"none"})}finally{this.loading=!1}},goToRecords(){e({url:"/pages/aroma-healing/booking-records"})},openBookingForm(a){this.selectedSalon=a,this.showBookingForm=!0,this.resetForm()},closeBookingForm(){this.showBookingForm=!1,this.selectedSalon=null,this.resetForm()},resetForm(){this.formData={name:"",phone:"",participants:1,remark:""},this.formErrors={}},validateForm(){const a=F.validateAromaBookingForm(this.formData),l={};return a.valid||a.errors.forEach((a=>{l[a.field]=a.message})),this.formErrors=l,a.valid},closeConfirmation(){this.showConfirmation=!1,this.confirmationData={salonTitle:"",salonDate:"",salonTime:"",salonLocation:"",name:"",phone:"",participants:1}},goToRecordsFromConfirm(){this.closeConfirmation(),this.goToRecords()},async submitBooking(){if(!this.validateForm())return;if(!this.selectedSalon)return void l({title:"è¯·é€‰æ‹©æ´»åŠ¨",icon:"none"});const a=await F.createAromaBooking(this.selectedSalon.id,this.selectedSalon,this.formData);if(a.success){const a=this.salons.findIndex((a=>a.id===this.selectedSalon.id));-1!==a&&(this.salons[a].availableSlots-=this.formData.participants||1),this.confirmationData={salonTitle:this.selectedSalon.title,salonDate:this.selectedSalon.date,salonTime:this.selectedSalon.time,salonLocation:this.selectedSalon.location,name:this.formData.name,phone:this.formData.phone,participants:this.formData.participants||1},this.showBookingForm=!1,this.showConfirmation=!0,this.selectedSalon=null,this.resetForm()}else l({title:a.message||"é¢„çº¦å¤±è´¥ï¼Œè¯·é‡è¯•",icon:"none"})}}},[["render",function(a,l,e,S,F,y){const B=s("custom-nav-bar"),T=k,w=n,x=C,V=b,E=v,j=D;return r(),o(w,{class:"salon-booking-container",style:i({paddingTop:F.navPaddingTop+"px"})},{default:t((()=>[c(B,{title:"çº¿ä¸‹é¦™æ°›æ²™é¾™é¢„çº¦",gradient:"linear-gradient(120deg, #880e4f 0%, #c2185b 45%, #e91e63 100%)"}),F.loading?(r(),o(w,{key:0,class:"loading"},{default:t((()=>[c(T,null,{default:t((()=>[d("åŠ è½½ä¸­...")])),_:1})])),_:1})):F.salons.length>0?(r(),o(w,{key:1,class:"salon-list"},{default:t((()=>[(r(!0),m(u,null,f(F.salons,(a=>(r(),o(w,{key:a.id,class:"salon-card"},{default:t((()=>[c(x,{src:a.image,class:"salon-cover",mode:"aspectFill"},null,8,["src"]),c(w,{class:"salon-content"},{default:t((()=>[c(T,{class:"salon-title"},{default:t((()=>[d(_(a.title),1)])),_:2},1024),c(T,{class:"salon-desc"},{default:t((()=>[d(_(a.description),1)])),_:2},1024),c(w,{class:"salon-theme"},{default:t((()=>[c(T,{class:"theme-tag"},{default:t((()=>[d(_(a.theme),1)])),_:2},1024)])),_:2},1024),c(w,{class:"salon-info"},{default:t((()=>[c(w,{class:"info-item"},{default:t((()=>[c(T,{class:"info-icon"},{default:t((()=>[d("ðŸ“…")])),_:1}),c(T,{class:"info-text"},{default:t((()=>[d(_(a.date)+" "+_(a.time),1)])),_:2},1024)])),_:2},1024),c(w,{class:"info-item"},{default:t((()=>[c(T,{class:"info-icon"},{default:t((()=>[d("ðŸ“")])),_:1}),c(T,{class:"info-text"},{default:t((()=>[d(_(a.location),1)])),_:2},1024)])),_:2},1024),c(w,{class:"info-item"},{default:t((()=>[c(T,{class:"info-icon"},{default:t((()=>[d("ðŸ‘¥")])),_:1}),c(T,{class:g(["info-text",{"sold-out":0===a.availableSlots}])},{default:t((()=>[d(_(0===a.availableSlots?"å·²æ»¡":`å‰©ä½™ ${a.availableSlots} ä¸ªåé¢`),1)])),_:2},1032,["class"])])),_:2},1024)])),_:2},1024),c(V,{class:g(["book-btn",{disabled:0===a.availableSlots}]),disabled:0===a.availableSlots,onClick:l=>y.openBookingForm(a)},{default:t((()=>[d(_(0===a.availableSlots?"å·²æ»¡":"ç«‹å³é¢„çº¦"),1)])),_:2},1032,["class","disabled","onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})):(r(),o(w,{key:2,class:"empty-state"},{default:t((()=>[c(T,{class:"empty-icon"},{default:t((()=>[d("ðŸŒ¸")])),_:1}),c(T,{class:"empty-text"},{default:t((()=>[d("æš‚æ— é¦™æ°›æ²™é¾™æ´»åŠ¨")])),_:1})])),_:1})),F.showBookingForm?(r(),o(w,{key:3,class:"booking-modal",onClick:h(y.closeBookingForm,["self"])},{default:t((()=>[c(w,{class:"modal-content"},{default:t((()=>[c(w,{class:"modal-header"},{default:t((()=>[c(T,{class:"modal-title"},{default:t((()=>[d("é¢„çº¦ä¿¡æ¯")])),_:1}),c(T,{class:"close-btn",onClick:y.closeBookingForm},{default:t((()=>[d("Ã—")])),_:1},8,["onClick"])])),_:1}),F.selectedSalon?(r(),o(w,{key:0,class:"selected-salon-info"},{default:t((()=>[c(T,{class:"salon-name"},{default:t((()=>[d(_(F.selectedSalon.title),1)])),_:1}),c(T,{class:"salon-datetime"},{default:t((()=>[d(_(F.selectedSalon.date)+" "+_(F.selectedSalon.time),1)])),_:1}),c(T,{class:"salon-place"},{default:t((()=>[d(_(F.selectedSalon.location),1)])),_:1})])),_:1})):p("",!0),c(w,{class:"form-group"},{default:t((()=>[c(T,{class:"form-label"},{default:t((()=>[d("å§“å "),c(T,{class:"required"},{default:t((()=>[d("*")])),_:1})])),_:1}),c(E,{class:g(["form-input",{error:F.formErrors.name}]),modelValue:F.formData.name,"onUpdate:modelValue":l[0]||(l[0]=a=>F.formData.name=a),placeholder:"è¯·è¾“å…¥æ‚¨çš„å§“å"},null,8,["class","modelValue"]),F.formErrors.name?(r(),o(T,{key:0,class:"error-text"},{default:t((()=>[d(_(F.formErrors.name),1)])),_:1})):p("",!0)])),_:1}),c(w,{class:"form-group"},{default:t((()=>[c(T,{class:"form-label"},{default:t((()=>[d("æ‰‹æœºå· "),c(T,{class:"required"},{default:t((()=>[d("*")])),_:1})])),_:1}),c(E,{class:g(["form-input",{error:F.formErrors.phone}]),modelValue:F.formData.phone,"onUpdate:modelValue":l[1]||(l[1]=a=>F.formData.phone=a),type:"number",placeholder:"è¯·è¾“å…¥æ‚¨çš„æ‰‹æœºå·"},null,8,["class","modelValue"]),F.formErrors.phone?(r(),o(T,{key:0,class:"error-text"},{default:t((()=>[d(_(F.formErrors.phone),1)])),_:1})):p("",!0)])),_:1}),c(w,{class:"form-group"},{default:t((()=>[c(T,{class:"form-label"},{default:t((()=>[d("å‚ä¸Žäººæ•°")])),_:1}),c(E,{class:"form-input",modelValue:F.formData.participants,"onUpdate:modelValue":l[2]||(l[2]=a=>F.formData.participants=a),type:"number",placeholder:"é»˜è®¤1äºº"},null,8,["modelValue"])])),_:1}),c(w,{class:"form-group"},{default:t((()=>[c(T,{class:"form-label"},{default:t((()=>[d("å¤‡æ³¨")])),_:1}),c(j,{class:"form-textarea",modelValue:F.formData.remark,"onUpdate:modelValue":l[3]||(l[3]=a=>F.formData.remark=a),placeholder:"å¦‚æœ‰ç‰¹æ®Šéœ€æ±‚è¯·å¤‡æ³¨"},null,8,["modelValue"])])),_:1}),c(V,{class:"submit-btn",onClick:y.submitBooking},{default:t((()=>[d("ç¡®è®¤é¢„çº¦")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["onClick"])):p("",!0),F.showConfirmation?(r(),o(w,{key:4,class:"booking-modal",onClick:h(y.closeConfirmation,["self"])},{default:t((()=>[c(w,{class:"modal-content confirmation-modal"},{default:t((()=>[c(w,{class:"success-icon"},{default:t((()=>[d("âœ“")])),_:1}),c(T,{class:"success-title"},{default:t((()=>[d("é¢„çº¦æˆåŠŸ")])),_:1}),c(w,{class:"confirmation-details"},{default:t((()=>[c(w,{class:"detail-item"},{default:t((()=>[c(T,{class:"detail-label"},{default:t((()=>[d("æ´»åŠ¨åç§°")])),_:1}),c(T,{class:"detail-value"},{default:t((()=>[d(_(F.confirmationData.salonTitle),1)])),_:1})])),_:1}),c(w,{class:"detail-item"},{default:t((()=>[c(T,{class:"detail-label"},{default:t((()=>[d("æ´»åŠ¨æ—¶é—´")])),_:1}),c(T,{class:"detail-value"},{default:t((()=>[d(_(F.confirmationData.salonDate)+" "+_(F.confirmationData.salonTime),1)])),_:1})])),_:1}),c(w,{class:"detail-item"},{default:t((()=>[c(T,{class:"detail-label"},{default:t((()=>[d("æ´»åŠ¨åœ°ç‚¹")])),_:1}),c(T,{class:"detail-value"},{default:t((()=>[d(_(F.confirmationData.salonLocation),1)])),_:1})])),_:1}),c(w,{class:"detail-item"},{default:t((()=>[c(T,{class:"detail-label"},{default:t((()=>[d("é¢„çº¦äºº")])),_:1}),c(T,{class:"detail-value"},{default:t((()=>[d(_(F.confirmationData.name),1)])),_:1})])),_:1}),c(w,{class:"detail-item"},{default:t((()=>[c(T,{class:"detail-label"},{default:t((()=>[d("è”ç³»ç”µè¯")])),_:1}),c(T,{class:"detail-value"},{default:t((()=>[d(_(F.confirmationData.phone),1)])),_:1})])),_:1}),c(w,{class:"detail-item"},{default:t((()=>[c(T,{class:"detail-label"},{default:t((()=>[d("å‚ä¸Žäººæ•°")])),_:1}),c(T,{class:"detail-value"},{default:t((()=>[d(_(F.confirmationData.participants)+"äºº",1)])),_:1})])),_:1})])),_:1}),c(w,{class:"confirmation-actions"},{default:t((()=>[c(V,{class:"view-records-btn",onClick:y.goToRecordsFromConfirm},{default:t((()=>[d("æŸ¥çœ‹æˆ‘çš„é¢„çº¦")])),_:1},8,["onClick"]),c(V,{class:"close-confirm-btn",onClick:y.closeConfirmation},{default:t((()=>[d("è¿”å›žæ´»åŠ¨åˆ—è¡¨")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["onClick"])):p("",!0)])),_:1},8,["style"])}],["__scopeId","data-v-adfab589"]]);export{B as default};
