import{g as e,s as a,n as t,m as l,c as s,w as o,d as i,i as n,o as c,a as r,b as d,e as f,r as m,F as u,v as p,t as _,p as h,h as x,f as g,q as k,I as b,x as v,u as D}from"./index-BDtgVNeI.js";import{C}from"./CustomNavBar.DdiFadKl.js";import{F as E}from"./food-booking.service.2lE7TaX9.js";import{_ as y}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./storage.service.D1zc2f4B.js";const F=y({components:{CustomNavBar:C},data:()=>({navPaddingTop:100,experiences:[],selectedExperience:null,showBookingForm:!1,showConfirmation:!1,loading:!0,confirmationData:{experienceTitle:"",experienceDate:"",experienceTime:"",experienceLocation:"",name:"",phone:"",participants:1},formData:{name:"",phone:"",participants:1,remark:""},formErrors:{}}),onLoad(){const a=e();this.navPaddingTop=(a.statusBarHeight||20)+75,this.loadExperiences()},methods:{async loadExperiences(){this.loading=!0;try{this.experiences=await E.getCookingExperiences()}catch(e){console.error("Failed to load experiences:",e),a({title:"åŠ è½½å¤±è´¥ï¼Œè¯·é‡è¯•",icon:"none"})}finally{this.loading=!1}},getDifficultyClass:e=>({"ç®€å•":"easy","ä¸­ç­‰":"medium","å›°éš¾":"hard"}[e]||"medium"),goToRecords(){t({url:"/pages/food-healing/booking-records"})},openBookingForm(e){this.selectedExperience=e,this.showBookingForm=!0,this.resetForm()},closeBookingForm(){this.showBookingForm=!1,this.selectedExperience=null,this.resetForm()},resetForm(){this.formData={name:"",phone:"",participants:1,remark:""},this.formErrors={}},validateForm(){const e=E.validateFoodBookingForm(this.formData),a={};return e.valid||e.errors.forEach((e=>{a[e.field]=e.message})),this.formErrors=a,e.valid},closeConfirmation(){this.showConfirmation=!1,this.confirmationData={experienceTitle:"",experienceDate:"",experienceTime:"",experienceLocation:"",name:"",phone:"",participants:1}},goToRecordsFromConfirm(){this.closeConfirmation(),this.goToRecords()},async submitBooking(){if(!this.validateForm())return;if(!this.selectedExperience)return void a({title:"è¯·é€‰æ‹©æ´»åŠ¨",icon:"none"});const e=await E.createFoodBooking(this.selectedExperience.id,this.selectedExperience,this.formData);if(e.success){const e=this.experiences.findIndex((e=>e.id===this.selectedExperience.id));-1!==e&&(this.experiences[e].availableSlots-=this.formData.participants||1),this.confirmationData={experienceTitle:this.selectedExperience.title,experienceDate:this.selectedExperience.date,experienceTime:this.selectedExperience.time,experienceLocation:this.selectedExperience.location,name:this.formData.name,phone:this.formData.phone,participants:this.formData.participants||1},this.showBookingForm=!1,this.showConfirmation=!0,this.selectedExperience=null,this.resetForm()}else a({title:e.message||"é¢„çº¦å¤±è´¥ï¼Œè¯·é‡è¯•",icon:"none"})}}},[["render",function(e,a,t,C,E,y){const F=l("custom-nav-bar"),B=g,T=n,w=D,V=k,S=b,j=v;return c(),s(T,{class:"cooking-booking-container",style:i({paddingTop:E.navPaddingTop+"px"})},{default:o((()=>[r(F,{title:"çº¿ä¸‹ç¾Žé£Ÿåˆ¶ä½œä½“éªŒé¢„çº¦",gradient:"linear-gradient(120deg, #e65100 0%, #ff8f00 45%, #ffb300 100%)"}),E.loading?(c(),s(T,{key:0,class:"loading"},{default:o((()=>[r(B,null,{default:o((()=>[d("åŠ è½½ä¸­...")])),_:1})])),_:1})):E.experiences.length>0?(c(),s(T,{key:1,class:"experience-list"},{default:o((()=>[(c(!0),f(u,null,m(E.experiences,(e=>(c(),s(T,{key:e.id,class:"experience-card"},{default:o((()=>[r(w,{src:e.image,class:"experience-cover",mode:"aspectFill"},null,8,["src"]),r(T,{class:"experience-content"},{default:o((()=>[r(B,{class:"experience-title"},{default:o((()=>[d(_(e.title),1)])),_:2},1024),r(B,{class:"experience-desc"},{default:o((()=>[d(_(e.description),1)])),_:2},1024),r(T,{class:"experience-tags"},{default:o((()=>[r(B,{class:"dish-tag"},{default:o((()=>[d("ðŸ³ "+_(e.dishName),1)])),_:2},1024),r(B,{class:x(["difficulty-tag",y.getDifficultyClass(e.difficulty)])},{default:o((()=>[d(_(e.difficulty),1)])),_:2},1032,["class"])])),_:2},1024),r(T,{class:"experience-info"},{default:o((()=>[r(T,{class:"info-item"},{default:o((()=>[r(B,{class:"info-icon"},{default:o((()=>[d("ðŸ“…")])),_:1}),r(B,{class:"info-text"},{default:o((()=>[d(_(e.date)+" "+_(e.time),1)])),_:2},1024)])),_:2},1024),r(T,{class:"info-item"},{default:o((()=>[r(B,{class:"info-icon"},{default:o((()=>[d("ðŸ“")])),_:1}),r(B,{class:"info-text"},{default:o((()=>[d(_(e.location),1)])),_:2},1024)])),_:2},1024),r(T,{class:"info-item"},{default:o((()=>[r(B,{class:"info-icon"},{default:o((()=>[d("ðŸ‘¥")])),_:1}),r(B,{class:x(["info-text",{"sold-out":0===e.availableSlots}])},{default:o((()=>[d(_(0===e.availableSlots?"å·²æ»¡":`å‰©ä½™ ${e.availableSlots} ä¸ªåé¢`),1)])),_:2},1032,["class"])])),_:2},1024)])),_:2},1024),r(V,{class:x(["book-btn",{disabled:0===e.availableSlots}]),disabled:0===e.availableSlots,onClick:a=>y.openBookingForm(e)},{default:o((()=>[d(_(0===e.availableSlots?"å·²æ»¡":"ç«‹å³é¢„çº¦"),1)])),_:2},1032,["class","disabled","onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})):(c(),s(T,{key:2,class:"empty-state"},{default:o((()=>[r(B,{class:"empty-icon"},{default:o((()=>[d("ðŸ‘¨â€ðŸ³")])),_:1}),r(B,{class:"empty-text"},{default:o((()=>[d("æš‚æ— ç¾Žé£Ÿåˆ¶ä½œä½“éªŒæ´»åŠ¨")])),_:1})])),_:1})),E.showBookingForm?(c(),s(T,{key:3,class:"booking-modal",onClick:p(y.closeBookingForm,["self"])},{default:o((()=>[r(T,{class:"modal-content"},{default:o((()=>[r(T,{class:"modal-header"},{default:o((()=>[r(B,{class:"modal-title"},{default:o((()=>[d("é¢„çº¦ä¿¡æ¯")])),_:1}),r(B,{class:"close-btn",onClick:y.closeBookingForm},{default:o((()=>[d("Ã—")])),_:1},8,["onClick"])])),_:1}),E.selectedExperience?(c(),s(T,{key:0,class:"selected-experience-info"},{default:o((()=>[r(B,{class:"experience-name"},{default:o((()=>[d(_(E.selectedExperience.title),1)])),_:1}),r(B,{class:"experience-datetime"},{default:o((()=>[d(_(E.selectedExperience.date)+" "+_(E.selectedExperience.time),1)])),_:1}),r(B,{class:"experience-place"},{default:o((()=>[d(_(E.selectedExperience.location),1)])),_:1})])),_:1})):h("",!0),r(T,{class:"form-group"},{default:o((()=>[r(B,{class:"form-label"},{default:o((()=>[d("å§“å "),r(B,{class:"required"},{default:o((()=>[d("*")])),_:1})])),_:1}),r(S,{class:x(["form-input",{error:E.formErrors.name}]),modelValue:E.formData.name,"onUpdate:modelValue":a[0]||(a[0]=e=>E.formData.name=e),placeholder:"è¯·è¾“å…¥æ‚¨çš„å§“å"},null,8,["class","modelValue"]),E.formErrors.name?(c(),s(B,{key:0,class:"error-text"},{default:o((()=>[d(_(E.formErrors.name),1)])),_:1})):h("",!0)])),_:1}),r(T,{class:"form-group"},{default:o((()=>[r(B,{class:"form-label"},{default:o((()=>[d("æ‰‹æœºå· "),r(B,{class:"required"},{default:o((()=>[d("*")])),_:1})])),_:1}),r(S,{class:x(["form-input",{error:E.formErrors.phone}]),modelValue:E.formData.phone,"onUpdate:modelValue":a[1]||(a[1]=e=>E.formData.phone=e),type:"number",placeholder:"è¯·è¾“å…¥æ‚¨çš„æ‰‹æœºå·"},null,8,["class","modelValue"]),E.formErrors.phone?(c(),s(B,{key:0,class:"error-text"},{default:o((()=>[d(_(E.formErrors.phone),1)])),_:1})):h("",!0)])),_:1}),r(T,{class:"form-group"},{default:o((()=>[r(B,{class:"form-label"},{default:o((()=>[d("å‚ä¸Žäººæ•°")])),_:1}),r(S,{class:"form-input",modelValue:E.formData.participants,"onUpdate:modelValue":a[2]||(a[2]=e=>E.formData.participants=e),type:"number",placeholder:"é»˜è®¤1äºº"},null,8,["modelValue"])])),_:1}),r(T,{class:"form-group"},{default:o((()=>[r(B,{class:"form-label"},{default:o((()=>[d("å¤‡æ³¨")])),_:1}),r(j,{class:"form-textarea",modelValue:E.formData.remark,"onUpdate:modelValue":a[3]||(a[3]=e=>E.formData.remark=e),placeholder:"å¦‚æœ‰ç‰¹æ®Šéœ€æ±‚è¯·å¤‡æ³¨ï¼ˆå¦‚é£Ÿç‰©è¿‡æ•ç­‰ï¼‰"},null,8,["modelValue"])])),_:1}),r(V,{class:"submit-btn",onClick:y.submitBooking},{default:o((()=>[d("ç¡®è®¤é¢„çº¦")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["onClick"])):h("",!0),E.showConfirmation?(c(),s(T,{key:4,class:"booking-modal",onClick:p(y.closeConfirmation,["self"])},{default:o((()=>[r(T,{class:"modal-content confirmation-modal"},{default:o((()=>[r(T,{class:"success-icon"},{default:o((()=>[d("âœ“")])),_:1}),r(B,{class:"success-title"},{default:o((()=>[d("é¢„çº¦æˆåŠŸ")])),_:1}),r(T,{class:"confirmation-details"},{default:o((()=>[r(T,{class:"detail-item"},{default:o((()=>[r(B,{class:"detail-label"},{default:o((()=>[d("æ´»åŠ¨åç§°")])),_:1}),r(B,{class:"detail-value"},{default:o((()=>[d(_(E.confirmationData.experienceTitle),1)])),_:1})])),_:1}),r(T,{class:"detail-item"},{default:o((()=>[r(B,{class:"detail-label"},{default:o((()=>[d("æ´»åŠ¨æ—¶é—´")])),_:1}),r(B,{class:"detail-value"},{default:o((()=>[d(_(E.confirmationData.experienceDate)+" "+_(E.confirmationData.experienceTime),1)])),_:1})])),_:1}),r(T,{class:"detail-item"},{default:o((()=>[r(B,{class:"detail-label"},{default:o((()=>[d("æ´»åŠ¨åœ°ç‚¹")])),_:1}),r(B,{class:"detail-value"},{default:o((()=>[d(_(E.confirmationData.experienceLocation),1)])),_:1})])),_:1}),r(T,{class:"detail-item"},{default:o((()=>[r(B,{class:"detail-label"},{default:o((()=>[d("é¢„çº¦äºº")])),_:1}),r(B,{class:"detail-value"},{default:o((()=>[d(_(E.confirmationData.name),1)])),_:1})])),_:1}),r(T,{class:"detail-item"},{default:o((()=>[r(B,{class:"detail-label"},{default:o((()=>[d("è”ç³»ç”µè¯")])),_:1}),r(B,{class:"detail-value"},{default:o((()=>[d(_(E.confirmationData.phone),1)])),_:1})])),_:1}),r(T,{class:"detail-item"},{default:o((()=>[r(B,{class:"detail-label"},{default:o((()=>[d("å‚ä¸Žäººæ•°")])),_:1}),r(B,{class:"detail-value"},{default:o((()=>[d(_(E.confirmationData.participants)+"äºº",1)])),_:1})])),_:1})])),_:1}),r(T,{class:"confirmation-actions"},{default:o((()=>[r(V,{class:"view-records-btn",onClick:y.goToRecordsFromConfirm},{default:o((()=>[d("æŸ¥çœ‹æˆ‘çš„é¢„çº¦")])),_:1},8,["onClick"]),r(V,{class:"close-confirm-btn",onClick:y.closeConfirmation},{default:o((()=>[d("è¿”å›žæ´»åŠ¨åˆ—è¡¨")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["onClick"])):h("",!0)])),_:1},8,["style"])}],["__scopeId","data-v-5ae4fd89"]]);export{F as default};
