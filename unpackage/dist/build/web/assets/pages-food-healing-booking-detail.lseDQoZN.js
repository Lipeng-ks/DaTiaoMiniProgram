import{s as a,y as e,c as t,w as o,i as s,o as l,a as n,b as i,t as c,h as d,p as f,f as u,q as r}from"./index-BDtgVNeI.js";import{F as g}from"./food-booking.service.2lE7TaX9.js";import{_}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./storage.service.D1zc2f4B.js";const k=_({data:()=>({bookingId:"",booking:null,loading:!0,canCancelBooking:!1}),onLoad(a){this.bookingId=a.id,this.loadBookingDetail()},methods:{async loadBookingDetail(){this.loading=!0;try{this.booking=await g.getFoodBookingDetail(this.bookingId),this.checkCanCancel()}catch(e){console.error("Failed to load booking detail:",e),a({title:"加载失败",icon:"none"})}finally{this.loading=!1}},checkCanCancel(){this.booking?this.canCancelBooking=g.canCancelFoodBooking(this.booking):this.canCancelBooking=!1},async handleCancel(){e({title:"确认取消",content:"确定要取消此预约吗？",success:async a=>{a.confirm&&await this.cancelBooking()}})},async cancelBooking(){try{const e=await g.cancelFoodBooking(this.bookingId);e.success?(a({title:"取消成功",icon:"success"}),await this.loadBookingDetail()):a({title:e.message,icon:"none"})}catch(e){console.error("Failed to cancel booking:",e),a({title:"取消失败",icon:"none"})}},getStatusClass:a=>({pending:"status-pending",confirmed:"status-confirmed",cancelled:"status-cancelled",completed:"status-completed"}[a]||""),getStatusIcon:a=>({pending:"⏳",confirmed:"✓",cancelled:"✕",completed:"★"}[a]||"?"),getStatusText:a=>({pending:"待确认",confirmed:"已确认",cancelled:"已取消",completed:"已完成"}[a]||a),formatDate(a){if(!a)return"";const e=new Date(a);return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")} ${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}`}}},[["render",function(a,e,g,_,k,b){const p=u,m=s,h=r;return l(),t(m,{class:"booking-detail-container"},{default:o((()=>[n(m,{class:"header"},{default:o((()=>[n(p,{class:"title"},{default:o((()=>[i("预约详情")])),_:1})])),_:1}),k.loading?(l(),t(m,{key:0,class:"loading"},{default:o((()=>[n(p,null,{default:o((()=>[i("加载中...")])),_:1})])),_:1})):k.booking?(l(),t(m,{key:1,class:"detail-content"},{default:o((()=>[n(m,{class:d(["status-card",b.getStatusClass(k.booking.status)])},{default:o((()=>[n(p,{class:"status-icon"},{default:o((()=>[i(c(b.getStatusIcon(k.booking.status)),1)])),_:1}),n(p,{class:"status-text"},{default:o((()=>[i(c(b.getStatusText(k.booking.status)),1)])),_:1})])),_:1},8,["class"]),n(m,{class:"info-section"},{default:o((()=>[n(p,{class:"section-title"},{default:o((()=>[i("活动信息")])),_:1}),n(m,{class:"info-card"},{default:o((()=>[n(m,{class:"info-row"},{default:o((()=>[n(p,{class:"info-label"},{default:o((()=>[i("活动名称")])),_:1}),n(p,{class:"info-value"},{default:o((()=>[i(c(k.booking.experienceTitle),1)])),_:1})])),_:1}),n(m,{class:"info-row"},{default:o((()=>[n(p,{class:"info-label"},{default:o((()=>[i("活动日期")])),_:1}),n(p,{class:"info-value"},{default:o((()=>[i(c(k.booking.experienceDate),1)])),_:1})])),_:1}),n(m,{class:"info-row"},{default:o((()=>[n(p,{class:"info-label"},{default:o((()=>[i("活动时间")])),_:1}),n(p,{class:"info-value"},{default:o((()=>[i(c(k.booking.experienceTime),1)])),_:1})])),_:1}),n(m,{class:"info-row"},{default:o((()=>[n(p,{class:"info-label"},{default:o((()=>[i("活动地点")])),_:1}),n(p,{class:"info-value"},{default:o((()=>[i(c(k.booking.experienceLocation),1)])),_:1})])),_:1})])),_:1})])),_:1}),n(m,{class:"info-section"},{default:o((()=>[n(p,{class:"section-title"},{default:o((()=>[i("预约人信息")])),_:1}),n(m,{class:"info-card"},{default:o((()=>[n(m,{class:"info-row"},{default:o((()=>[n(p,{class:"info-label"},{default:o((()=>[i("姓名")])),_:1}),n(p,{class:"info-value"},{default:o((()=>[i(c(k.booking.formData.name),1)])),_:1})])),_:1}),n(m,{class:"info-row"},{default:o((()=>[n(p,{class:"info-label"},{default:o((()=>[i("手机号")])),_:1}),n(p,{class:"info-value"},{default:o((()=>[i(c(k.booking.formData.phone),1)])),_:1})])),_:1}),n(m,{class:"info-row"},{default:o((()=>[n(p,{class:"info-label"},{default:o((()=>[i("参与人数")])),_:1}),n(p,{class:"info-value"},{default:o((()=>[i(c(k.booking.formData.participants)+"人",1)])),_:1})])),_:1}),k.booking.formData.remark?(l(),t(m,{key:0,class:"info-row"},{default:o((()=>[n(p,{class:"info-label"},{default:o((()=>[i("备注")])),_:1}),n(p,{class:"info-value"},{default:o((()=>[i(c(k.booking.formData.remark),1)])),_:1})])),_:1})):f("",!0)])),_:1})])),_:1}),n(m,{class:"info-section"},{default:o((()=>[n(p,{class:"section-title"},{default:o((()=>[i("预约时间")])),_:1}),n(m,{class:"info-card"},{default:o((()=>[n(m,{class:"info-row"},{default:o((()=>[n(p,{class:"info-label"},{default:o((()=>[i("创建时间")])),_:1}),n(p,{class:"info-value"},{default:o((()=>[i(c(b.formatDate(k.booking.createdAt)),1)])),_:1})])),_:1}),k.booking.updatedAt!==k.booking.createdAt?(l(),t(m,{key:0,class:"info-row"},{default:o((()=>[n(p,{class:"info-label"},{default:o((()=>[i("更新时间")])),_:1}),n(p,{class:"info-value"},{default:o((()=>[i(c(b.formatDate(k.booking.updatedAt)),1)])),_:1})])),_:1})):f("",!0)])),_:1})])),_:1}),k.canCancelBooking?(l(),t(m,{key:0,class:"action-section"},{default:o((()=>[n(h,{class:"cancel-btn",onClick:b.handleCancel},{default:o((()=>[i("取消预约")])),_:1},8,["onClick"]),n(p,{class:"cancel-tip"},{default:o((()=>[i("距离活动开始超过24小时可取消")])),_:1})])),_:1})):"confirmed"===k.booking.status||"pending"===k.booking.status?(l(),t(m,{key:1,class:"action-section"},{default:o((()=>[n(p,{class:"cannot-cancel-tip"},{default:o((()=>[i("距离活动开始不足24小时，无法取消")])),_:1})])),_:1})):f("",!0)])),_:1})):(l(),t(m,{key:2,class:"empty-state"},{default:o((()=>[n(p,{class:"empty-text"},{default:o((()=>[i("未找到预约信息")])),_:1})])),_:1}))])),_:1})}],["__scopeId","data-v-dd4b163d"]]);export{k as default};
